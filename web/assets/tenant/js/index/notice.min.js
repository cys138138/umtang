window.Notice=window.PageBase.init(function(){function t(t,e){t.toggleClass("hide",0==e.length),PageBase.cloneItem(t,e.length,!0,!0).each(function(t){var a=$(this),i=e[t];a.toggleClass("unread",0==i.is_read),a.toggleClass("no-content",""==i.content),a.data("nid",i.id),a.find(".J-title").text(i.title),a.find(".J-detail").text(i.content),a.find(".J-date").text(Tools.date("Y-m-d",i.create_time))})}var e={listCache:[]};this.initPage=function(){var a=this,i=a.getConfig("selector"),n=a.getTemplate(),d=$(n);d.find(".J-item").click(function(){var t=$(this);t.toggleClass("show").siblings(".show").removeClass("show"),t.hasClass("unread")&&(t.removeClass("unread"),ajax({url:a.getConfig("readUrl"),data:{id:t.data("nid")}}))});var s=a.getConfig("noticeListUrl"),l=UmtPageNum.build();l.bind(UmtPageNum.EVENT_PAGE_CHANGE,function(a,i){var n=d.find(".J-item");if(e.listCache[i])return UmtPageNum.update(l,i),void t(n,e.listCache[i]);var o=10;ajax({url:s,data:{page:i,pageSize:o}}).done(function(a){var d=Math.ceil(a.data.totalCount/o);e.listCache[i]=a.data.aList,UmtPageNum.update(l,i,d),t(n,e.listCache[i])})}).triggerHandler(UmtPageNum.EVENT_PAGE_CHANGE,1),d.find(".J-page-num").append(l),$(i).append(d)}});