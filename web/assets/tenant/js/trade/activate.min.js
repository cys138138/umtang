window.Activate=window.PageBase.init(function(){this.initPage=function(){var e=this,t=e.getConfig("selector"),i=e.getTemplate(),a=$(i);a.find(".J-search-form").on("submit",function(){var t=serializeObject($(this)),i=t.code;return a.find(".J-code").text(i),ajax({url:e.getConfig("infoUrl"),data:{goodsCode:i}}).done(function(e){var t=a.find(".J-info"),n=e.data.order,d=1!=n.goods_info.is_validity,o=0==n.activation_time;t.removeClass("hide"),t.next().addClass("hide"),t.parent().removeClass("hide"),t.find(".J-name").text(n.goods_info.name),t.find(".J-count").text(n.quantity),t.find(".J-price").text(Tools.parsePrice(n.price)),t.find(".J-user").text(n.user_name),t.find(".J-mobile").text(n.mobile),t.find(".J-pay-date").text(Tools.date("Y-m-d",n.pay_time)),t.find(".J-validity-date").text(Tools.date("Y-m-d",n.goods_info.validity_time)),t.find(".J-validity-status").text(d?"已过期":"有效期内").toggleClass(function(){return d?"disable":"usable"}),t.find(".J-status").text(o?"未使用":"已使用").toggleClass("usable",o),t.find(".J-active-btn").data("code",i).prop("disabled",d||!o)}),!1}),a.find(".J-active-btn").click(function(){var t=$(this);ajax({url:e.getConfig("activateUrl"),data:{goodsCode:t.data("code")}}).done(function(e){a.find(".J-info").addClass("hide").next().removeClass("hide")})}),a.find(".J-reset-btn").click(function(){$(this).parents(".J-result, .J-search-result").addClass("hide"),a.find(".J-search-form")[0].reset()}),$(t).append(a)}});